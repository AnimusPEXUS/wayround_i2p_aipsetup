#!/usr/bin/python

import os
import os.path
import sys
import glob
import subprocess
import shutil

import aipsetup.utils
import aipsetup.getopt2

def print_help():
    print """\
   usage: %(basename)s [command] [command_parameters]

   commands:

      info          Pkg info files actions
      buildinfo     Build info files actions
      builders      builder files actions

      build         Building actions
      server        UHT server related actions
      client        Download actions
      pkgindex      Package index actions

      name          Tools for parsing file names
      docbook       Docbook tools


      help          see this help
      version       version info
""" % {
        'basename': os.path.basename(__file__)
        }
    return


config = aipsetup.utils.load_config()
if config == None:
    print "-e- configuration file error exiting"
    exit(1)

ret = 0


optilist, args = aipsetup.getopt2.getopt(sys.argv[1:])
args_l = len(args)


if args_l == 0:
    print "-e- no commands or parameters passed. try aipsetup help"
    exit(1)
else:

    if args[0] == 'help':
        print_help()

    elif args[0] in ['info', 'buildinfo', 'builders',
                     'build', 'server', 'client',
                     'pkgindex', 'name', 'docbook']:

        exec("import aipsetup.%(name)s" % {
                'name': args[0]
                })

        exec("ret = aipsetup.%(name)s.router(optilist, args[1:], config)" % {
                'name': args[0]
                })

    else:
        print "-e- wrong command. try aipsetup help"

exit(ret)
